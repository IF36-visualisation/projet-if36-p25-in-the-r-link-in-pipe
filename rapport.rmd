
---
title: "Rapport d'exploration - HLTB"

---

## Le genre d’un jeu influence-t-il sa durée de complétion ?

### Hypothèse

Nous supposons que le genre d’un jeu vidéo influence fortement sa durée de complétion. Par exemple, les jeux de rôle ou d’aventure demanderaient plus d’heures pour être terminés, notamment en mode "completionist", tandis que les jeux de course ou de plateforme seraient plus courts.

---
## Code

library(dplyr)
library(stringr)
library(tidyr)
library(networkD3)
library(htmltools)

hltb <- read.csv("C:/Users/virgi/Desktop/UTT/IF36/hltb_clean.csv", stringsAsFactors = FALSE)
# hltb <- read.csv("hltb_clean.csv", stringsAsFactors = FALSE)

# 1. Convertir les durées textuelles en minutes
convert_to_minutes <- function(time_str) {
  if (is.na(time_str) || time_str == "" || grepl("--", time_str)) return(NA)
  h <- as.numeric(str_extract(time_str, "\\d+(?=h)"))
  m <- as.numeric(str_extract(time_str, "\\d+(?=m)"))
  h[is.na(h)] <- 0
  m[is.na(m)] <- 0
  return(h * 60 + m)
}

# 2. Appliquer la conversion
hltb <- hltb %>%
  mutate(
    main_story_min = sapply(main_story, convert_to_minutes),
    extras_min = sapply(extras, convert_to_minutes),
    completionist_min = sapply(completionist, convert_to_minutes)
  )

# 3. Nettoyer les lignes valides
cleaned <- hltb %>%
  filter(!is.na(main_story_min) | !is.na(extras_min) | !is.na(completionist_min))

# 4. Générer les genres décomposés
genres_expanded <- cleaned %>%
  separate_rows(Genres, sep = ",\\s*") %>%
  mutate(Genres = str_trim(Genres))

# 5. Générer les 4 Sankey sélectionnés
selected_genres <- c("First-Person", "Action", "Shooter", "Open World")

plots <- list()

for (genre in selected_genres) {
  genre_data <- genres_expanded %>% filter(Genres == genre)
  
  main_total <- sum(!is.na(genre_data$main_story_min))
  extras_total <- sum(!is.na(genre_data$extras_min))
  completionist_total <- sum(!is.na(genre_data$completionist_min))
  
  # Empiler les flux
  nb_completionist <- completionist_total
  nb_extras_only <- extras_total + completionist_total
  nb_main_only <- main_total + nb_extras_only + nb_completionist
  
  main_avg <- mean(genre_data$main_story_min, na.rm = TRUE)
  extras_avg <- mean(genre_data$extras_min, na.rm = TRUE)
  completionist_avg <- mean(genre_data$completionist_min, na.rm = TRUE)
  
  nodes_genre <- data.frame(name = c(
    paste0("Joueurs (", genre, ")"),
    paste0("Main Only (\n", round(100 * main_total / (main_total+ extras_total +completionist_total)), "%) | Temps moyen ", round(main_avg), " min "),
    paste0("Main + Extras (\n", round(100 * extras_total / (main_total+ extras_total +completionist_total)), "%) | Temps moyen ", round(extras_avg), " min"),
    paste0("Completionist (\n", round(100 * completionist_total /(main_total+ extras_total +completionist_total)), "%) | Temps moyen ", round(completionist_avg), " min" )
  ))
  
  links_genre <- data.frame(
    source = c(0, 0, 0),
    target = c(1, 2, 3),
    value  = c(nb_main_only, nb_extras_only, nb_completionist)
  )
  
  sankey <- sankeyNetwork(
    Links = links_genre, Nodes = nodes_genre,
    Source = "source", Target = "target", Value = "value",
    NodeID = "name", fontSize = 26, nodeWidth = 30,
    sinksRight = FALSE,
    colourScale = JS("d3.scaleOrdinal(d3.schemeCategory10)")
  )
  
  plots[[genre]] <- sankey
}


# 6. Afficher tous les Sankey côte à côte dans le Viewer R
browsable(
  div(
    style = "display: flex; flex-wrap: wrap; gap: 20px;",
    lapply(plots, function(p) {
      div(style = "flex: 1 1 48%; min-width: 400px;", p)
    })
  )
)

### Visualisation

```{r fig.align='center', echo=FALSE, out.width='80%'}
knitr::include_graphics("tps_moy_genre_mode.png")
```

---

### Interprétation

Ce graphique permet de comparer le **temps de jeu moyen par genre** selon trois modes de complétion : `main_story`, `extras` et `completionist`.

- Les **jeux de rôle (Role-Playing)** sont clairement les plus longs, notamment en mode *completionist* où la moyenne dépasse 75h.
- Les **jeux de course** ont aussi une durée moyenne importante en mode completionist, bien plus que ce que l’on aurait pu anticiper.
Cela peut s'expliquer par le fait que les jeux de courses contiennent des saisons avec un certain nombre de courses à effectuer (entre 15 et 30). L'echec d'une seule course par saison suffit pour ne pas pouvoir terminer le jeu à 100% et prends donc beaucoup plus de temps de manière générale.
- À l’inverse, les **shooters** et **platformers** sont globalement plus courts, rarement au-dessus de 10-15h même en mode étendu.
Cela semble logique car les joueurs de shooters s'interessent plus à des modes compétitifs et les plateformeurs sont de manière générale plus courts et faciles a terminer que des jeux de rôle ou d'aventure.
- 
Ces résultats confirment que le genre du jeu est un bon prédicteur de sa durée. Il serait intéressant d’approfondir cette analyse en croisant la durée avec d’autres variables comme le prix pour voir par exemple si des jeux plus chèrs sont plus complets et par conséquent, plus long à terminer.

---


```
