---
title: "Rapport d'exploration - Temps de jeu"
title: "IF36_Markdown"
author: "In the R - Link In Pipe"
date: "2025-04-28"
always_allow_html: true
output:
  pdf_document: default
  html_document: default
---

# Le genre d’un jeu influence-t-il sa durée de complétion ?

## Hypothèse

Nous supposons que le genre d’un jeu vidéo influence fortement sa durée de complétion. Par exemple, les jeux de rôle ou d’aventure demanderaient plus d’heures pour être terminés, notamment en mode "completionist", tandis que les jeux de course ou de plateforme seraient plus courts.

---
## Code
```{r}
library(dplyr)
library(stringr)
library(tidyr)
library(networkD3)
library(htmltools)
library(magrittr)
library(ggplot2)

hltb <- read.csv("C:/Users/virgi/Desktop/UTT/IF36/hltb_clean.csv", stringsAsFactors = FALSE)
# hltb <- read.csv("hltb_clean.csv", stringsAsFactors = FALSE)
```


### 1. Convertir les durées textuelles en minutes
```{r}
convert_to_minutes <- function(time_str) {
  if (is.na(time_str) || time_str == "" || grepl("--", time_str)) return(NA)
  h <- as.numeric(str_extract(time_str, "\\d+(?=h)"))
  m <- as.numeric(str_extract(time_str, "\\d+(?=m)"))
  h[is.na(h)] <- 0
  m[is.na(m)] <- 0
  return(h * 60 + m)
}
```

### 2. Appliquer la conversion
```{r}
hltb <- hltb %>%
  mutate(
    main_story_min = sapply(main_story, convert_to_minutes),
    extras_min = sapply(extras, convert_to_minutes),
    completionist_min = sapply(completionist, convert_to_minutes)
  )
```

### 3. Nettoyer les lignes valides
```{r}
cleaned <- hltb %>%
  filter(!is.na(main_story_min) | !is.na(extras_min) | !is.na(completionist_min))
```

### 4. Générer les genres décomposés
```{r}
genres_expanded <- cleaned %>%
  separate_rows(Genres, sep = ",\\s*") %>%
  mutate(Genres = str_trim(Genres))
```

### 5. Générer les 4 Sankey sélectionnés
```{r}
selected_genres <- c("First-Person", "Action", "Shooter", "Open World")

plots <- list()

for (genre in selected_genres) {
  genre_data <- genres_expanded %>% filter(Genres == genre)
  
  main_total <- sum(!is.na(genre_data$main_story_min))
  extras_total <- sum(!is.na(genre_data$extras_min))
  completionist_total <- sum(!is.na(genre_data$completionist_min))
  
  # Empiler les flux
  nb_completionist <- completionist_total
  nb_extras_only <- extras_total + completionist_total
  nb_main_only <- main_total + nb_extras_only + nb_completionist
  
  main_avg <- mean(genre_data$main_story_min, na.rm = TRUE)
  extras_avg <- mean(genre_data$extras_min, na.rm = TRUE)
  completionist_avg <- mean(genre_data$completionist_min, na.rm = TRUE)
  
  nodes_genre <- data.frame(name = c(
    paste0("Joueurs (", genre, ")"),
    paste0("Main Only (\n", round(100 * main_total / (main_total+ extras_total +completionist_total)), "%) | Temps moyen ", round(main_avg), " min "),
    paste0("Main + Extras (\n", round(100 * extras_total / (main_total+ extras_total +completionist_total)), "%) | Temps moyen ", round(extras_avg), " min"),
    paste0("Completionist (\n", round(100 * completionist_total /(main_total+ extras_total +completionist_total)), "%) | Temps moyen ", round(completionist_avg), " min" )
  ))
  
  links_genre <- data.frame(
    source = c(0, 0, 0),
    target = c(1, 2, 3),
    value  = c(nb_main_only, nb_extras_only, nb_completionist)
  )
  
  sankey <- sankeyNetwork(
    Links = links_genre, Nodes = nodes_genre,
    Source = "source", Target = "target", Value = "value",
    NodeID = "name", fontSize = 26, nodeWidth = 30,
    sinksRight = FALSE,
    colourScale = JS("d3.scaleOrdinal(d3.schemeCategory10)")
  )
  
  plots[[genre]] <- sankey
}
```

### 6. Afficher tous les Sankey côte à côte dans le Viewer R
browsable(
  div(
    style = "display: flex; flex-wrap: wrap; gap: 20px;",
    lapply(plots, function(p) {
      div(style = "flex: 1 1 48%; min-width: 400px;", p)
    })
  )
)

### Visualisation

```{r fig.align='center', echo=FALSE, out.width='80%'}
knitr::include_graphics("tps_moy_genre_mode.png")
```

---

## Interprétation

Ce graphique permet de comparer le **temps de jeu moyen par genre** selon trois modes de complétion : `main_story`, `extras` et `completionist`.

- Les **jeux de rôle (Role-Playing)** sont clairement les plus longs, notamment en mode *completionist* où la moyenne dépasse 75h.
- Les **jeux de course** ont aussi une durée moyenne importante en mode completionist, bien plus que ce que l’on aurait pu anticiper.
Cela peut s'expliquer par le fait que les jeux de courses contiennent des saisons avec un certain nombre de courses à effectuer (entre 15 et 30). L'echec d'une seule course par saison suffit pour ne pas pouvoir terminer le jeu à 100% et prends donc beaucoup plus de temps de manière générale.
- À l’inverse, les **shooters** et **platformers** sont globalement plus courts, rarement au-dessus de 10-15h même en mode étendu.
Cela semble logique car les joueurs de shooters s'interessent plus à des modes compétitifs et les plateformeurs sont de manière générale plus courts et faciles a terminer que des jeux de rôle ou d'aventure.
- 
Ces résultats confirment que le genre du jeu est un bon prédicteur de sa durée. Il serait intéressant d’approfondir cette analyse en croisant la durée avec d’autres variables comme le prix pour voir par exemple si des jeux plus chèrs sont plus complets et par conséquent, plus long à terminer.

---



---

# Dans quelle mesure la proportion d'avis positifs par rapport aux avis négatifs des jeux vidéos influence-t-elle le temps passé sur ces jeux ?

Pour répondre à cette question, nous cherchons à réaliser un histogramme comparant les avis des joueurs au temps de jeu moyen et médian passé sur les jeux.

## Code

### Filtrage des données

```{r}
ratings_playtime <- read.csv("steam.csv") %>% filter(average_playtime != 0) %>% mutate(
  average_playtime_hours = round(average_playtime / 60, 2),
  median_playtime_hours = round(median_playtime / 60, 2),
  percent_positive_ratings = round(100 * positive_ratings / (positive_ratings + negative_ratings))
) %>% select(percent_positive_ratings,
             average_playtime_hours,
             median_playtime_hours)
```

### Création des buckets d'avis positifs

```{r}
ratings_summary <- ratings_playtime %>%
  mutate(
    rating_bucket = cut(
      percent_positive_ratings,
      breaks = c(0, 25, 50, 75, 100),
      labels = c("0-25%", "25-50%", "50-75%", "75-100%"),
      include.lowest = TRUE
    )
  ) %>%
  group_by(rating_bucket) %>%
  summarise(
    average_playtime = mean(average_playtime_hours, na.rm = TRUE),
    median_playtime = median(median_playtime_hours, na.rm = TRUE)
  )
```

### Génération du graphique

```{r, fig.width=12, fig.height=7}
ggplot(ratings_summary, aes(x = rating_bucket)) +
  geom_col(aes(y = average_playtime, fill = "Moyenne"), width = 0.6) +
  geom_col(aes(y = median_playtime, fill = "Médiane"), width = 0.3) +
  geom_text(
    aes(y = average_playtime, label = round(average_playtime, 1)),
    vjust = -0.5,
    size = 4,
    color = "#ff8b00",
    fontface = "bold"
  ) +
  geom_text(
    aes(y = median_playtime, label = round(median_playtime, 1)),
    vjust = -0.5,
    size = 4,
    color = "#9fcaff",
    fontface = "bold"
  ) +
  scale_fill_manual(values = c("Moyenne" = "#0074ff", "Médiane" = "#ff8b00"),
                    name = "") +
  labs(
    title = "Comparaison du temps de jeu moyen et médian par tranche d'avis positifs",
    subtitle = "Source : Steam (jeux avec temps de jeu non nul)",
    x = "Pourcentage d'avis positifs",
    y = "Temps de jeu (heures)"
  ) +
  theme(
    plot.title = element_text(
      hjust = 0.5,
      size = 18,
      face = "bold",
      color = "black"
    ),
    plot.subtitle = element_text(
      hjust = 0.5,
      size = 12,
      color = "black"
    ),
    axis.title = element_text(size = 14, color = "black"),
    axis.text = element_text(size = 12, color = "black"),
    panel.grid.major = element_line(color = "grey90"),
    panel.grid.minor = element_blank()
  )
```

---

# Question : Il y a t il une corrélation entre le temps de jeu et son genre ?

## Hypothèse

Pour cette analyse, nous avons voulu identifier quels étaient les jeux présentant les **temps de jeu moyens les plus élevés** sur Steam et **les genres associés**.  
**Notre hypothèse** est que certains types de jeux, comme les **jeux de simulation** ou les **multijoueurs**, pourraient inciter à des sessions de jeu beaucoup plus longues que d’autres genres plus rapides ou épisodiques.


```{r genre_les_plus_joues, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
library(stringr)

# Charger les données depuis le CSV
steam <- read.csv("/Users/tifenn/Downloads/rapport/steam.csv") # chemin local

names(steam)

# Nettoyer les genres : extraire le premier genre
steam <- steam %>%
  filter(!is.na(genres), average_playtime > 0) %>%
  mutate(
    genre_main = str_split(genres, ";", simplify = TRUE)[,1],
    average_playtime_hours = average_playtime / 60
  )

# Calculer la moyenne du temps de jeu par genre
genre_summary <- steam %>%
  group_by(genre_main) %>%
  summarise(mean_playtime = mean(average_playtime_hours, na.rm = TRUE)) %>%
  arrange(desc(mean_playtime))

# Afficher le graphique
ggplot(genre_summary, aes(x = reorder(genre_main, mean_playtime), y = mean_playtime, fill = genre_main)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(
    title = "Temps moyen de jeu par genre",
    x = "Genre",
    y = "Temps moyen (heures)"
  ) +
  theme_minimal()
```

### Interprétation des résultats

Le graphique **valide notre hypothèse**, montrant clairement que les jeux de type **"Massively Multiplayer"** (MMORPG) et **"Free to Play"** enregistrent les temps de jeu moyens les plus élevés. Cela peut s’expliquer par leur fonctionnement : les MMORPG sont conçus pour retenir les joueurs sur le long terme grâce à des systèmes d’évolution progressive, de missions quotidiennes, d’interactions sociales et d'abonnement. Les jeux Free to Play, souvent multijoueurs eux aussi, encouragent également une forte rétention pour maximiser leur modèle économique basé sur les microtransactions.

À l'inverse, des genres comme **"Casual"**, **"Photo Editing"**, **"Nudity"** ou encore **"Gore"** affichent des temps moyens bien plus courts. Ces catégories correspondent souvent à des expériences plus brèves, peut être de par leur contenu limité, ou parce que leur public recherche des sessions de jeu rapides.

Cependant, avec cette visualisation il est assez difficile d'en tirer une analyse complète. Nous avons donc réalisé une **seconde analyse** plus précise, centrée sur les **15 jeux les plus joués**. Cela permet d'illustrer concrètement quels jeux dominent vraiment en termes de durée, et de voir si certains genre sortent alors du lot.

## Graphique 2

```{r jeux_plus_joues_par_genre, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
library(stringr)

# Nettoyage : extraire le premier genre
steam_clean_simple <- steam %>%
  filter(!is.na(average_playtime), average_playtime > 0, genres != "") %>%
  mutate(
    average_playtime_hours = average_playtime / 60,
    genre_main = str_split(genres, ";") |> sapply(\(x) str_trim(x[1]))
  )

# Sélection des 15 jeux les plus joués
top_jeux_simple <- steam_clean_simple %>%
  arrange(desc(average_playtime_hours)) %>%
  slice_head(n = 15)

# Nouveau graphique
ggplot(top_jeux_simple, aes(x = reorder(name, average_playtime_hours), y = average_playtime_hours, fill = genre_main)) +
  geom_col() +
  coord_flip() +
  labs(
    title = "Les 15 jeux les plus joués sur Steam par genre principal",
    x = "Jeu",
    y = "Temps moyen de jeu (en heures)",
    fill = "Genre principal"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom", legend.text = element_text(size = 8))
```

### Interprétation des résultats

Le graphique obtenu montre que :

- Certains jeux avec un genre **Adventure** ou **Free to Play** apparaissent comme ayant des **temps de jeu moyens particulièrement élevés**.
- Parmis les 5 premiers, **3** font partie du genre **Adventure**.
- Les **jeux de genre indépendants (Indie)** orientés du même type figurent parmi les titres les plus joués en termes de durée.
- Cela **confirme partiellement notre hypothèse** : les genres favorisant **l'exploration** ou **l'investissement dans un personnage** tendent à engendrer des sessions de jeu beaucoup plus longues. **Cependant** nous sommes plutôt surpris de ne pas voir plus de jeux **Multijoueurs** en haut du classement, comme le montrait le premier graphique, qui ont notament une durée de vie quasi **illimité**. 

### Hypothèse 

Nous pouvons formuler l’hypothèse suivante : si le genre "Massively Multiplayer" apparaît très largement en tête dans le graphique 1 (temps moyen par genre), c’est parce que les jeux multijoueurs en ligne sont conçus pour encourager un investissement très long dans la durée (progression continue, événements récurrents, interactions sociales), mais ils restent peu nombreux en nombre de titres comparé aux jeux d'aventure ou free-to-play. Ainsi, dans le graphique 2, les jeux d'aventure et free-to-play dominent car ils sont beaucoup plus représentés dans le catalogue global et certains titres très populaires tirent leur genre vers le haut en termes de temps joué.

### Remarque

Il est important de préciser que ce dataset date de **2019**.
Depuis, les jeux les plus joués sur Steam ont largement évolué, d'après Steam [Classement actuel des jeux les plus joués sur Steam (SteamDB)](https://steamdb.info/charts/) : des titres comme Counter-Strike 2, Dota 2 ou encore PUBG dominent aujourd'hui les classements. Les tendances actuelles sont donc significativement différentes de celles observées dans cette visualisation.

---
